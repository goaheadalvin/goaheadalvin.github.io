---
layout: post
title: "BP误差反传神经网络"
excerpt: "一种多层网络的“逆推”学习算法"
categories: blog
tags: [编程, 神经网络]
author: Alvin
comments: true
share: true
---

####基本思想  
学习过程由信号的正向传播与误差的反向传播两个过程组成,可以逼近任意连续函数，具有很强的非线性映射能力。  
正向传播时,输入样本从输入层传入,经隐层逐层处理后,传向输出层。若输出层的实际输出与期望输出(教师信号)不符,则转向误差的反向传播阶段。   
误差的反向传播是将输出误差以某种形式通过隐层向输入层逐层反传,并将误差分摊给各层的所有单元,从而获得各层单元的误差信号,此误差信号即作为修正各单元权值的依据。  

>这种信号正向传播与误差反向传播的各层权值调整过程,是周而复始地进行。权值不断调整过程,也就是网络的学习训练过程。此过程一直进行到网络输出的误差减少到可以接受的程度,或进行到预先设定的学习次数为 止。

>BP网络能学习和存贮大量的输入-输出模式映射关系，而无需事前揭示描述这种映射关系的数学方程。  
它的学习规则是使用最速下降法，通过反向传播来不断调整网络的权值和阈值，使网络的误差平方和最小。  
BP神经网络模型拓扑结构包括输入层（input）、隐层(hide layer)和输出层(output layer)。

<figure >
<img src="/postimage/AI2/bp.png" alt="BP model">
</figure>   

- BP网络前向传播计算  
<figure >
<img src="/postimage/AI2/bp2.png" >
</figure>  

- BP网络后退计算  
<figure >
<img src="/postimage/AI2/bp3.png" >
</figure>  
<figure >
<img src="/postimage/AI2/bp4.png" >
</figure>   
<figure >
<img src="/postimage/AI2/bp5.png" >
</figure>  
<figure >
<img src="/postimage/AI2/bp6.png" >
</figure>

####改进  
- #####误差曲面与BP算法的局限性
<figure >
<img src="/postimage/AI2/bp7.png" >
</figure>  
<figure >
<img src="/postimage/AI2/bp8.png" >
</figure>  
<figure >
<img src="/postimage/AI2/bp9.png" >
</figure>  
<figure >
<img src="/postimage/AI2/bp10.png" >
</figure>  

(2)局限 2   
存在多个极小点。从两维权空间的误差曲面可以看出,其上存在许多凸凹不平,其低凹部分就是误差函数的极小点。可以想象多维权空间的误差曲面,会更加复杂,存在更多个局 部极小点,它们的特点都是误差梯度为0。BP算法权值调整依据是误差梯度下降,当梯度为0时,BP算法无法辨别极小点性质,因此训练常陷入某个局部极小点而不能自拔,使训练难以收敛于给定误差。  

- #####标准BP算法改进   

从上面的分析可知,误差曲面的平坦区将使误差下降缓慢,调整时间加长,迭代次数增多,影响收敛速度;而误差曲面存在的多个极小点会使网络训练陷入局部极小,从而使网络训练无法收敛于给定误差。以上两个问题是BP网络标准算法的固有缺陷。下面介绍几种典型的改进算法。  
<figure >
<img src="/postimage/AI2/bp11.png" >
</figure>  
<figure >
<img src="/postimage/AI2/bp12.png" >
</figure>  
<figure >
<img src="/postimage/AI2/bp13.png" >
</figure>  

####BP神经网络设计的一般原则虽然BP神经网络是目前应用最广泛,研究较多的一种网络。但关于它的开发设计到目 前为止还没有一套完整的理论。大多数是根据使用者的经验来设计网络结构、功能函数、学习算法、样本等。  
  
#####BP网络参数设计  - #####BP网络输入与输出参数的确定输入量的选择  (1) 输入量必须选择那些对输出影响大且能够检测或提取的变量。  
(2) 各输入量之间互不相关或相关性很小。  从输入、输出量性质分类来看,可以分为两类:数值变量和语言变量。  
数值变量又分为连续变量或离散变量。如常见的温度,压力,电压,电流等就是连续变量;语言变量是用自然语言表示的概念。如红,绿,蓝;男,女;大,中,小,开,关,亮,暗等。一般来说, 语言变量在网络处理时,需要转化为离散变量。  (3) 输入量的表示与提取大多数情况下,直接送给神经网络的输入量无法直接得到,常常需要用信号处理与特征提取技术从原始数据中提取能反映其特征的若干参数作为网络输入。以下是几个典型特征处 理实例。例2-1 文字符号输入——英文字母识别(C I T)。  
<figure >
<img src="/postimage/AI2/bp14.png" >
</figure>  
<figure >
<img src="/postimage/AI2/bp15.png" >
</figure><figure >
<img src="/postimage/AI2/bp16.png" >
</figure>   

#####训练样本集的设计  
网络的性能与训练用的样本密切相关,设计一个好的训练样本集既要注意样本规模,有要注意样本质量。  
- 样本数目的确定  一般来说样本数n越多,训练结果越能正确反映其内在规律,但样本的获取往往有一定困难,另一方面,当样本数n达到一定数量后,网络的精度也很难提高。  
选择原则:网络规模越大,网络映射关系越复杂,样本数越多。一般说来,训练样本数是网络连接权总数的5~10倍,但许多情况难以达到这样的要求。  
 - 样本的选择和组织  (1)样本要有代表性,注意样本类别的均衡。  
(2)样本的组织要注意将不同类别的样本交叉输入。  
(3)网络的训练测试,测试标准是看网络是否有好的泛化能力。  
测试做法:不用样本训练集中数据测试。一般是将收集到的可用样本随机地分成两部分,一部分为训练集,另一部分为测试集。若训练样本误差很小,而对测试集的样本误差很大,泛化能力差。  
3. 初始权值的设计  网络权值的初始化决定了网络的训练从误差曲面的哪一点开始,因此初始化方法对缩短 网络的训练时间至关重要。  神经元的作用函数是关于坐标点对称的,若每个节点的净输入均在零点附近,则输出均出在作用函数的中点,这个位置不仅远离作用函数的饱和区,而且是其变化最灵敏的区域, 必使网络学习加快。从神经网络净输入表达式来看,为了使各节点的初始净输入在零点附近, 如下两种方法被常常使用。  方法一:取足够小的初始权值;   
方法二:使初始值为+1 和-1 的权值数相等。   

####BP 网络结构参数设计1. 隐层结构设计  隐层数设计  理论证明:具有单隐层的前馈网络可以映射所有连续函数,只有当学习不连续函数时才需要两个隐层,故一般情况隐层最多需要两层。一般方法是先设一个隐层,当一个隐层的节点数很多,仍不能改善网络性能时,再增加一个隐层。最常用的BP神经网络结构是3层结构,即输入层、输出层和1个隐层。  
2. 隐层节点数设计  隐层节点数目对神经网络的性能有一定的影响。隐层节点数过少时,学习的容量有限,不足以存储训练样本中蕴涵的所有规律;隐层节点过多不仅会增加网络训练时间,而且会将样本中非规律性的内容如干扰和噪声存储进去。反而降低泛化能力。一般方法是凑试法:   
(1)先由经验公式确定  
<figure >
<img src="/postimage/AI2/bp17.png" >
</figure>
m为隐层节点数, n为输入节点,l输出节点,α为调节常数在 1~10 之间。  
 (2)改变m,用同一样本集训练,从中确定网络误差最小时对应的隐层节点数。  
<a href="http://idl.hbdlib.cn/book/00000000000000/pdfbook/018/017/178480.pdf" target="_blank">BP神经网络的应用举例: p40-p54</a> 

&nbsp;   


参考链接:  
<a href="http://automation.seu.edu.cn/SS001/upload/2010_4_17_%E7%AC%AC3%E7%AB%A0%20%E5%A4%9A%E5%B1%82%E6%84%9F%E7%9F%A5%E5%99%A8%EF%BC%88%E4%B8%8B%EF%BC%9ABP%E7%AE%97%E6%B3%95%EF%BC%89.pdf" target="_blank">BP网与BP算法</a>   
<a href="http://www.cnblogs.com/wentingtu/archive/2012/06/05/2536425.html" target="_blank">BP神经模型与算法</a>  
<a href="http://hahack.com/reading/ann2/#" target="_blank">BP神经网络</a>   




&nbsp;   

<!-- 多说评论框 start -->
<div class="ds-thread" data-thread-key="BP" data-title="BP" ></div>
<!-- 多说评论框 end -->
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"goaheadalvin"};
(function() {
var ds = document.createElement('script');
ds.type = 'text/javascript';ds.async = true;
ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
ds.charset = 'UTF-8';
(document.getElementsByTagName('head')[0] 
|| document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script>
<!-- 多说公共JS代码 end -->